<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Dashboard</title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/dashboard.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script src="/js/filesaver.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
    <style>
        table{
            margin-left: 0;
        }
        .card.mb-3 {
    width: 100%;
}
a{
  cursor: pointer;
  text-decoration: none !important;
}
.order-report {
    background: linear-gradient(to bottom, #3d94f6 5%, #1a386a 100%);
    background-color: #81a719;
    border-radius: 5px;
    border: 1px solid #506b91;
    display: inline-block;
    cursor: pointer;
    color: #ffffff;
    font-family: Arial;
    font-size: 16px;
    font-weight: bold;
    padding: 6px 14px;
    text-decoration: none;
    position: relative;
    left: 893px;
}
.order-report:hover {
  background: linear-gradient(to bottom, #3d94f6 5%, #1a386a 100%);
    background-color: #81a719;
	background-color:#1e62d0;
  color: white;
}
.order-report:active {
	position:relative;
	top:1px;
}
a#pdf-report {
    color: #f1f1f1;
    margin-left: 613px;
}

.pdf-report {
	background:linear-gradient(to bottom, #d0451b 5%, #f53913 100%);
	background-color:#d0451b;
	border-radius:5px;
	border:2px solid #942911;
	display:inline-block;
	cursor:pointer;
	color:#ffffff;
	font-family:Arial;
	font-size:13px;
	padding:6px 24px;
	text-decoration:none;
}
.pdf-report:hover {
	background:linear-gradient(to bottom, #f53913 5%, #d0451b 100%);
	background-color:#f53913;
}
.pdf-report:active {
	position:relative;
	top:1px;
}

canvas {
  border: 1px dotted red;
}

.chart-container {
  position: relative;
  margin: auto;
  height: 80vh;
  width: 80vw;
}
#chart{
      display: block;
    height: 288px;
    width: 1205px;
}


    </style>
  </head>
  
  
  <body class="fixed-nav sticky-footer bg-dark" id="page-top">
    <!-- Navigation-->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
<a class="navbar-brand" href="/">Agriculture Market</a>
<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
  <span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarResponsive">
  <ul class="navbar-nav navbar-sidenav" id="exampleAccordion">
    <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Dashboard">
      <a class="nav-link" href="/seller/dashboard">
        <i class="fa fa-fw fa-dashboard"></i>
        <span class="nav-link-text">Dashboard</span>
      </a>
    </li>
    <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Add Items">
      <a class="nav-link" href="/seller/additem">
        <i class="fa fa-fw fa-cart-plus"></i>
        <span class="nav-link-text">Add Items</span>
      </a>
    </li>
    <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Manage Items">
      <a class="nav-link" href="/seller/manageitem">
        <i class="fa fa-fw fa-bars"></i>
        <span class="nav-link-text">Manage Items</span>
      </a>
    </li>
    <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Comments">
        <a class="nav-link" href="/seller/comments">
          <i class="fa fa-fw fa-commenting-o"></i>
          <span class="nav-link-text">Comments</span>
        </a>
      </li>
      <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Order">
        <a class="nav-link" href="/seller/order">
          <i class="fa fa-fw fa-shopping-cart"></i>
          <span class="nav-link-text">Order</span>
        </a>
      </li>
    <li class="nav-item" data-toggle="tooltip" data-placement="right" title="Components">
      <a class="nav-link nav-link-collapse collapsed" data-toggle="collapse" href="#collapseComponents" data-parent="#exampleAccordion">
        <i class="fa fa-fw fa-wrench"></i>
        <span class="nav-link-text">Components</span>
      </a>
      <ul class="sidenav-second-level collapse" id="collapseComponents">
        <li>
          <a href="/seller/comments">Comments</a>
        </li>
        <li>
          <a href="/seller/message">Message</a>
        </li>
      </ul>
    </li>
   
  </ul>


              <ul class="navbar-nav sidenav-toggler">
                <li class="nav-item">
                  <a class="nav-link text-center" id="sidenavToggler">
                    <i class="fa fa-fw fa-angle-left"></i>
                  </a>
                </li>
              </ul>
              <ul class="topnav navbar-nav ml-auto">

                <!-- message alert dropdown start -->
               
                <!-- message alert dropdown end-->
        
        
                
                
                <li class="nav-item">
                    <a href="/seller/profile" class="nav-link">
                        <i class=" color-white fa fa-fw fa-user"></i>Profile</a>
                  </li>
        
        
                <li class="nav-item color-red">
                  <a class="nav-link color-red" data-toggle="modal" data-target="#exampleModal">
                    <i  class="color-red fa fa-fw fa-sign-out"></i>Logout</a>
                </li>
              </ul>
            </div>
          </nav>
    <!-- nav end -->



  <div class="content-wrapper">
    <div class="container-fluid">
      <!-- Breadcrumbs-->
      <ol class="breadcrumb">
        <li class="breadcrumb-item">
          <a href="#">Dashboard</a>
        </li>
        <li class="breadcrumb-item active">My Dashboard</li>
      </ol>
      <!-- Icon Cards-->
      <div class="row">
        <div class="col-xl-3 col-sm-6 mb-3">
          <div class="card text-white bg-primary o-hidden h-100">
            <div class="card-body">
              <div class="card-body-icon">
                <i class="fa fa-fw fa-comments"></i>
              </div>
              <div class="mr-5"> <%=commentcount %>  reviews!</div>
            </div>
            <a class="card-footer text-white clearfix small z-1" href="/seller/comments">
              <span class="float-left">View Details</span>
              <span class="float-right">
                <i class="fa fa-angle-right"></i>
              </span>
            </a>
          </div>
        </div>
        <div class="col-xl-3 col-sm-6 mb-3">
          <div class="card text-white bg-warning o-hidden h-100">
            <div class="card-body">
              <div class="card-body-icon">
                <i class="fa fa-fw fa-list"></i>
              </div>
              <div class="mr-5"> <%=productcount %> Products!</div>
            </div>
            <a class="card-footer text-white clearfix small z-1" href="/seller/manageitem">
              <span class="float-left">View Details</span>
              <span class="float-right">
                <i class="fa fa-angle-right"></i>
              </span>
            </a>
          </div>
        </div>
        <div class="col-xl-3 col-sm-6 mb-3">
          <div class="card text-white bg-success o-hidden h-100">
            <div class="card-body">
              <div class="card-body-icon">
                <i class="fa fa-fw fa-shopping-cart"></i>
              </div>
              <div class="mr-5"> <%=ordercount %> Orders!</div>
            </div>
            <a class="card-footer text-white clearfix small z-1" href="/seller/order">
              <span class="float-left">View Details</span>
              <span class="float-right">
                <i class="fa fa-angle-right"></i>
              </span>
            </a>
          </div>
        </div>

        <div class="chart-container">
          <canvas id="chart"></canvas>
        </div>


        

     
            <!-- Example Social Card-->
            
          <!-- Example Notifications Card-->
         
      <!-- Example DataTables Card-->
      <div class="card mb-3" id="pdfprint">
        <div class="card-header">
          <i class="fa fa-table"></i> Completed oeders
          <a id="order-report"  class="order-report">Excel Report</a>
          <a id="pdf-report"  class="pdf-report"><i class="fa fa-file-pdf-o" aria-hidden="true"></i> PDF Report</a>
        
        </div>
          
        <div class="card-body">
          <div class="table-responsive">
            <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
              <thead>
                <tr>
                  <th>Order ID</th>
                  <th>Product Name</th>
                  <th>date</th>
                  <th>Action</th>
                 
                </tr>
              </thead>
              <% 
              items.forEach( function(item){ %>
              <tr>
                  <td><%= item.orderid %></td>
                  <td><%= item.pname %></td>
                  <td><%= item.date %></td>
                  <td>
               
                    <a class="editdltbtn2"  id="dltitembtn" href="/seller/order" value="<%= item.orderid %>" >View</a>
                    
                  </td>
              </tr>

              
      
          <%
              }); 
          %>
               
              </tbody>
            </table>
          </div>
        </div>
        
      </div> 



    </div>
    <!-- /.container-fluid-->
    <!-- /.content-wrapper-->
    <footer class="sticky-footer">
      <div class="container">
        <div class="text-center">
          <small>Copyright © Rakibul</small>
        </div>
      </div>
    </footer>
    <!-- Scroll to Top Button-->
    <a class="scroll-to-top rounded" href="#page-top">
      <i class="fa fa-angle-up"></i>
    </a>


    <!-- Logout Modal-->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Ready to Leave?</h5>
            <button class="close" type="button" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">×</span>
            </button>
          </div>
          <div class="modal-body">Select "Logout" below if you are ready to end your current session.</div>
          <div class="modal-footer">
            <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
            <a id="logoutbtn" class="btn btn-primary logoutbtn">Logout</a>
          </div>
        </div>
      </div>
    </div>


  </div>

        

    


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
    
    <script>

// -- main function start

const EXCEL_TYPE = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';
const EXCEL_EXTENSION = '.xlsx';
$(document).ready(function() {

  // chart start

  $.ajax({

url: "/seller/report",
type: "POST",
data: {

'sellerid': 'seller id'

},
success: function(response) {
  showchart(response.length);


},
error: function (request, status, error) {
//alert('error');  //it will show error in webpage if any
}

});


  
  //alert(monthdata);

  function showchart(lastdata){
    let monthdata =  [.4, .2, .2, .6, .1, .3, 1];
  monthdata[6]= lastdata;
    
  var data = {
  labels: ["May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov"],
  datasets: [{
    label: "Total order per month",
    backgroundColor: "rgba(255,99,132,0.2)",
    borderColor: "rgba(255,99,132,1)",
    borderWidth: 2,
    hoverBackgroundColor: "rgba(255,99,132,0.4)",
    hoverBorderColor: "rgba(255,99,132,1)",
    data: monthdata,
  }]
};

var options = {
  maintainAspectRatio: false,
  scales: {
    yAxes: [{
      stacked: true,
      gridLines: {
        display: true,
        color: "rgba(255,99,132,0.2)"
      }
    }],
    xAxes: [{
      gridLines: {
        display: false
      }
    }]
  }
};

Chart.Bar('chart', {
  options: options,
  data: data
});

  }




  // chart end
  

  function downloadexcel(data) {
    const worksheet = XLSX.utils.json_to_sheet(data);
    const workbook = {
      Sheets:{
        'data': worksheet
      },
      SheetNames :['data']
    };
    const excelBuffer= XLSX.write(workbook, {booktype: 'xlsx', type: 'array'});
    console.log(excelBuffer);
    saveexcel(excelBuffer, 'order_report');
  }
  function saveexcel(buffer, filename) {
    const data =new Blob([buffer], {type: EXCEL_TYPE});
    saveAs(data, filename+'_export_'+new Date().getTime()+EXCEL_EXTENSION);
    
  }

      // var dltid = $(this).attr("value");
    // // alert(dltid);
    // report(dltid); 
  $('.order-report').click(function() {

$.ajax({

url: "/seller/report",
type: "POST",
data: {

'sellerid': 'seller id'

},
success: function(response) {

downloadexcel(response);
// window.location.href= '/seller/manageitem/delete/confirm';



},
error: function (request, status, error) {
//alert('error');  //it will show error in webpage if any
}

});
    
  });


  
// pdf generator

document.getElementById("pdf-report")
        .addEventListener("click", () => {
            const pdfprint = document.getElementById("pdfprint");
            
            
            html2pdf().from(pdfprint).save();
        })



// pdf generator end
 










  $('.logoutbtn').click(function(){
      

      $.ajax({
      method: "GET", 
      url: "/logout", 
     
    })
    .done(function( res ) {
        
        window.location.href= '/login';
    });






  });


});

(function($) {
  "use strict"; // Start of use strict
  // Configure tooltips for collapsed side navigation
  $('.navbar-sidenav [data-toggle="tooltip"]').tooltip({
    template: '<div class="tooltip navbar-sidenav-tooltip" role="tooltip" style="pointer-events: none;"><div class="arrow"></div><div class="tooltip-inner"></div></div>'
  })
  // Toggle the side navigation
  $("#sidenavToggler").click(function(e) {
    e.preventDefault();
    $("body").toggleClass("sidenav-toggled");
    $(".navbar-sidenav .nav-link-collapse").addClass("collapsed");
    $(".navbar-sidenav .sidenav-second-level, .navbar-sidenav .sidenav-third-level").removeClass("show");
  });
  // Force the toggled class to be removed when a collapsible nav link is clicked
  $(".navbar-sidenav .nav-link-collapse").click(function(e) {
    e.preventDefault();
    $("body").removeClass("sidenav-toggled");
  });
  // Prevent the content wrapper from scrolling when the fixed side navigation hovered over
  $('body.fixed-nav .navbar-sidenav, body.fixed-nav .sidenav-toggler, body.fixed-nav .navbar-collapse').on('mousewheel DOMMouseScroll', function(e) {
    var e0 = e.originalEvent,
      delta = e0.wheelDelta || -e0.detail;
    this.scrollTop += (delta < 0 ? 1 : -1) * 30;
    e.preventDefault();
  });
  // Scroll to top button appear
  $(document).scroll(function() {
    var scrollDistance = $(this).scrollTop();
    if (scrollDistance > 100) {
      $('.scroll-to-top').fadeIn();
    } else {
      $('.scroll-to-top').fadeOut();
    }
  });
  // Configure tooltips globally
  $('[data-toggle="tooltip"]').tooltip()
  // Smooth scrolling using jQuery easing
  $(document).on('click', 'a.scroll-to-top', function(event) {
    var $anchor = $(this);
    $('html, body').stop().animate({
      scrollTop: ($($anchor.attr('href')).offset().top)
    }, 1000, 'easeInOutExpo');
    event.preventDefault();
  });
})(jQuery); // End of use strict
      
    </script>
      </body>
</html>